!function(){function a(b,c){var d,e;return this instanceof a?(this.html=b,this.opts=c,d=document.createElement("div"),d.className="olay",e=document.createElement("div"),e.className="select-box",this.el=d,this.layer_el=e,this.init(),void 0):new a(b,c)}function b(a,b,c){iosSelectUtil.isArray(b)&&0!==b.length&&(this.data=b,this.level=a||1,this.options=c,this.typeBox=1===this.level?"one-level-box":2===this.level?"two-level-box":"three-level-box",this.callback=c.callback,this.title=c.title||"",this.itemHeight=c.itemHeight||35,this.headerHeight=c.headerHeight||44,this.init())}iosSelectUtil={isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"function"==typeof a},attrToData:function(a,b){var c,d={};for(c in a.dataset)d[c]=a.dataset[c];return d.dom=a,d.atindex=b,d},attrToHtml:function(a){var b,c="";for(b in a)c+="data-"+b+'="'+a[b]+'"';return c}},a.prototype={init:function(){this.layer_el.innerHTML=this.html,document.body.appendChild(this.el),this.el.appendChild(this.layer_el),this.el.style.height=Math.max(document.documentElement.getBoundingClientRect().height,window.innerHeight),this.opts.className&&(this.el.className+=" "+this.opts.className),this.bindEvent()},bindEvent:function(){var a,b,c=this.el.querySelectorAll(".sure"),d=this.el.querySelectorAll(".close"),e=this;for(a=0,b=c.length;b>a;a++)c[a].addEventListener("click",function(){e.close()});for(a=0,b=d.length;b>a;a++)d[a].addEventListener("click",function(){e.close()})},close:function(){this.el&&(this.el.parentNode.removeChild(this.el),this.el=null)}},b.prototype={init:function(){this.initLayer(),this.selectOneObj={},this.selectTwoObj={},this.selectThreeObj={},this.setOneLevel(this.options.oneLevelId,this.options.twoLevelId,this.options.threeLevelId)},initLayer:function(){var b=this,c=['<div class="btnbox">','<span id="iosSelectTitle"></span>','<a href="javascript:void(0)" class="close">取消</a>','<a href="javascript:void(0)" class="sure">确定</a>',"</div>","<section>",'<div class="one-level-contain" id="oneLevelContain">','<ul class="select-one-level">',"</ul>","</div>",'<div class="two-level-contain" id="twoLevelContain">','<ul class="select-two-level">',"</ul>","</div>",'<div class="three-level-contain" id="threeLevelContain">','<ul class="select-three-level">',"</ul>","</div>","</section>",'<hr class="mark-line1"/>','<hr class="mark-line2"/>'].join("\r\n");this.iosSelectLayer=new a(c,{className:"select-dialog "+this.typeBox+(this.options.addClassName?" "+this.options.addClassName:"")}),this.iosSelectTitleDom=document.querySelector("#iosSelectTitle"),this.options.title&&(this.iosSelectTitleDom.innerHTML=this.options.title),this.options.headerHeight&&this.options.itemHeight&&(this.coverArea1Dom=document.querySelector(".cover-area1"),this.coverArea1Dom.style.top=this.headerHeight+3*this.itemHeight+"px",this.coverArea2Dom=document.querySelector(".cover-area2"),this.coverArea2Dom.style.top=this.headerHeight+4*this.itemHeight+"px"),this.oneLevelContainDom=document.querySelector("#oneLevelContain"),this.twoLevelContainDom=document.querySelector("#twoLevelContain"),this.threeLevelContainDom=document.querySelector("#threeLevelContain"),this.oneLevelUlContainDom=document.querySelector(".select-one-level"),this.twoLevelUlContainDom=document.querySelector(".select-two-level"),this.threeLevelUlContainDom=document.querySelector(".select-three-level"),this.iosSelectLayer.el.querySelector(".select-box").style.height=3*this.itemHeight+this.headerHeight+"px",this.oneLevelContainDom.style.height=7*this.itemHeight+"px",this.scrollOne=new IScroll("#oneLevelContain",{probeType:3,bounce:!1}),this.scrollOne.on("scrollStart",function(){Array.prototype.slice.call(b.oneLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")})}),this.scrollOne.on("scroll",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=1;d=Math.round(c)+1,Array.prototype.slice.call(b.oneLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a=b.oneLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),a.classList.add("now"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2")}),this.scrollOne.on("scrollEnd",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=1,e=0;Math.ceil(c)===Math.round(c)?(e=Math.ceil(c)*b.itemHeight,d=Math.ceil(c)+1):(e=Math.floor(c)*b.itemHeight,d=Math.floor(c)+1),b.scrollOne.scrollTo(0,-e,0),a=b.oneLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),Array.prototype.slice.call(b.oneLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a.classList.add("now"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.oneLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2"),b.selectOneObj=iosSelectUtil.attrToData(a,d),b.level>1&&1===b.options.oneTwoRelation&&b.setTwoLevel(b.selectOneObj.id)}),this.level>=2&&(this.twoLevelContainDom.style.height=7*this.itemHeight+"px",this.scrollTwo=new IScroll("#twoLevelContain",{probeType:3,bounce:!1}),this.scrollTwo.on("scrollStart",function(){Array.prototype.slice.call(b.twoLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")})}),this.scrollTwo.on("scroll",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=0;d=Math.round(c)+1,a=b.twoLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),Array.prototype.slice.call(b.twoLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a.classList.add("now"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2")}),this.scrollTwo.on("scrollEnd",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=1,e=0;Math.ceil(c)===Math.round(c)?(e=Math.ceil(c)*b.itemHeight,d=Math.ceil(c)+1):(e=Math.floor(c)*b.itemHeight,d=Math.floor(c)+1),b.scrollTwo.scrollTo(0,-e,0),a=b.twoLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),Array.prototype.slice.call(b.twoLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a.classList.add("now"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.twoLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2"),b.selectTwoObj=iosSelectUtil.attrToData(a,d),3===b.level&&1===b.options.twoThreeRelation&&b.setThreeLevel(b.selectOneObj.id,b.selectTwoObj.id)})),3===this.level&&(this.threeLevelContainDom.style.height=7*this.itemHeight+"px",this.scrollThree=new IScroll("#threeLevelContain",{probeType:3,bounce:!1}),this.scrollThree.on("scrollStart",function(){Array.prototype.slice.call(b.threeLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")})}),this.scrollThree.on("scroll",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=0;d=Math.round(c)+1,a=b.threeLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),Array.prototype.slice.call(b.threeLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a.classList.add("now"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2")}),this.scrollThree.on("scrollEnd",function(){var a,c=Math.abs(this.y)/b.itemHeight,d=1,e=0;Math.ceil(c)===Math.round(c)?(e=Math.ceil(c)*b.itemHeight,d=Math.ceil(c)+1):(e=Math.floor(c)*b.itemHeight,d=Math.floor(c)+1),b.scrollThree.scrollTo(0,-e,0),a=b.threeLevelContainDom.querySelector("li:nth-child("+(d+3)+")"),Array.prototype.slice.call(b.threeLevelContainDom.querySelectorAll("li")).forEach(function(a){a.classList.contains("now")?a.classList.remove("now"):a.classList.contains("side1")?a.classList.remove("side1"):a.classList.contains("side2")&&a.classList.remove("side2")}),a.classList.add("now"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+2)+")").classList.add("side1"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+1)+")").classList.add("side2"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+4)+")").classList.add("side1"),b.threeLevelContainDom.querySelector("li:nth-child("+(d+5)+")").classList.add("side2"),b.selectThreeObj=iosSelectUtil.attrToData(a,d)})),this.selectBtnDom=this.iosSelectLayer.el.querySelector(".sure"),this.selectBtnDom.addEventListener("click",function(){b.callback&&b.callback(b.selectOneObj,b.selectTwoObj,b.selectThreeObj),b.iosSelectLayer.close()})},getOneLevel:function(){if(iosSelectUtil.isArray(this.data[0]))return this.data[0];if(iosSelectUtil.isFunction(this.data[0]))return this.data[0]();throw new Error("data format error")},setOneLevel:function(a,b,c){var d,e,f,g=this.getOneLevel();a||(a=g[0]["id"]),d="",e=0,d+="<li></li>",d+="<li></li>",d+="<li></li>",g.forEach(function(b,c){b.id===a?(d+="<li "+iosSelectUtil.attrToHtml(b)+' class="now">'+b.value+"</li>",e=c+1+3):d+="<li "+iosSelectUtil.attrToHtml(b)+">"+b.value+"</li>"}),d+="<li></li>",d+="<li></li>",d+="<li></li>",this.oneLevelUlContainDom.innerHTML=d,this.scrollOne.refresh(),this.scrollOne.scrollToElement("li:nth-child("+(e-3)+")",0),this.level>=2&&this.setTwoLevel(a,b,c),f=this.oneLevelContainDom.querySelector(".now"),this.oneLevelContainDom.querySelector("li:nth-child("+(e-1)+")").classList.add("side1"),this.oneLevelContainDom.querySelector("li:nth-child("+(e-2)+")").classList.add("side2"),this.oneLevelContainDom.querySelector("li:nth-child("+(e+1)+")").classList.add("side1"),this.oneLevelContainDom.querySelector("li:nth-child("+(e+2)+")").classList.add("side2"),this.selectOneObj=iosSelectUtil.attrToData(f,e)},getTwoLevel:function(a){var b=[];if(iosSelectUtil.isArray(this.data[1]))return 1===this.options.oneTwoRelation?this.data[1].forEach(function(c){c.parentId===a&&b.push(c)}):b=this.data[1],b;if(iosSelectUtil.isFunction(this.data[1]))return this.data[1](a);throw new Error("data format error")},setTwoLevel:function(a,b,c){var d,e,f,g=this.getTwoLevel(a),h=0;b||(b=g[0]["id"]),d="",e=this,d+="<li></li>",d+="<li></li>",d+="<li></li>",g.forEach(function(a,c){a.id===b?(d+="<li "+iosSelectUtil.attrToHtml(a)+' class="now">'+a.value+"</li>",h=c+1+3):d+="<li "+iosSelectUtil.attrToHtml(a)+">"+a.value+"</li>"}),d+="<li></li>",d+="<li></li>",d+="<li></li>",this.twoLevelUlContainDom.innerHTML=d,this.scrollTwo.refresh(),this.scrollTwo.scrollToElement(":nth-child("+(h-3)+")",0),3===this.level&&this.setThreeLevel(a,b,c),f=e.twoLevelContainDom.querySelector("li:nth-child("+h+")"),f.classList.add("now"),e.twoLevelContainDom.querySelector("li:nth-child("+(h-1)+")").classList.add("side1"),e.twoLevelContainDom.querySelector("li:nth-child("+(h-2)+")").classList.add("side2"),e.twoLevelContainDom.querySelector("li:nth-child("+(h+1)+")").classList.add("side1"),e.twoLevelContainDom.querySelector("li:nth-child("+(h+2)+")").classList.add("side2"),e.selectTwoObj=iosSelectUtil.attrToData(f,h)},getThreeLevel:function(a,b){var c=[];if(iosSelectUtil.isArray(this.data[2]))return 1===this.options.twoThreeRelation?this.data[2].forEach(function(a){a.parentId===b&&c.push(a)}):c=this.data[2],c;if(iosSelectUtil.isFunction(this.data[2]))return this.data[2](a,b);throw new Error("data format error")},setThreeLevel:function(a,b,c){var d,e,f,g=this.getThreeLevel(a,b),h=0;return void 0==g||null==g||g.length<=0?(this.threeLevelUlContainDom.innerHTML="",void 0):(c||(c=g[0]["id"]),d="",e=this,d+="<li></li>",d+="<li></li>",d+="<li></li>",g.forEach(function(a,b){a.id===c?(d+="<li "+iosSelectUtil.attrToHtml(a)+' class="now">'+a.value+"</li>",h=b+1+3):d+="<li "+iosSelectUtil.attrToHtml(a)+">"+a.value+"</li>"}),d+="<li></li>",d+="<li></li>",d+="<li></li>",this.threeLevelUlContainDom.innerHTML=d,this.scrollThree.refresh(),this.scrollThree.scrollToElement(":nth-child("+(h-3)+")",0),f=e.threeLevelContainDom.querySelector("li:nth-child("+h+")"),f.classList.add("now"),e.threeLevelContainDom.querySelector("li:nth-child("+(h-1)+")").classList.add("side1"),e.threeLevelContainDom.querySelector("li:nth-child("+(h-2)+")").classList.add("side2"),e.threeLevelContainDom.querySelector("li:nth-child("+(h+1)+")").classList.add("side1"),e.threeLevelContainDom.querySelector("li:nth-child("+(h+2)+")").classList.add("side2"),e.selectThreeObj=iosSelectUtil.attrToData(f,h),void 0)}},"undefined"!=typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):window.IosSelect=b}();