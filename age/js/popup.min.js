!function(a,b,c){b.popup={doc:a(c),htm:a("html,body"),popup_tpl:'<div class="_popup"><div class="layer is"><div class="doc"></div><div class="btnbox"></div></div></div>',cue_tpl:'<div class="_cue"><span></span></div>',_M:/Mobile|Browser/i.test(navigator.userAgent),_Q:/MQQBrowser/i.test(navigator.userAgent),_S:/SamsungBrowser/i.test(navigator.userAgent),_S:/SamsungBrowser/i.test(navigator.userAgent),_W:/MicroMessenger/i.test(navigator.userAgent),_iI:!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),_T:function(b){return"number"===a.type(b)&&Math.abs(b)>0?b:0},_O:function(){var a=navigator.userAgent;return a.indexOf("Android")>-1&&a.indexOf("Linux")>-1&&a.substr(a.indexOf("Android")+8,3)<"4.0"?1:0}(),_iS:function(a,b){function c(a,b){d.css({"-webkit-transform":"translate3d(0px,"+-1*a+"px,0px)","-webkit-transition-duration":b+"ms",transform:"translate3d(0px,"+-1*a+"px,0px)","transition-duration":b+"ms",position:"absolute",top:0,left:0})}var d=a.find(".out"),e=[0,0,0],f=[0,0,0];e[0]=d.height(),e[1]=b,d.parent().on("touchstart",function(a){f[0]=a.originalEvent.changedTouches[0].pageY||0}).on("touchmove",function(a){a.preventDefault(),f[1]=a.originalEvent.changedTouches[0].pageY||0,c(e[2]+f[0]-f[1],0)}).on("touchend",function(a){f[2]=a.originalEvent.changedTouches[0].pageY||0,e[2]+=f[0]-f[1],e[2]=e[2]<=0?0:e[2]>=e[0]-e[1]?e[0]-e[1]:e[2],f[0]!=f[2]&&0!=f[0]-f[1]&&c(e[2],400)})},_iF:function(a,d){var e=a.find(".cont"),f=e.siblings("h2"),g=a.find(".btnbox"),h=b.innerHeight-f.height()-g.height();null==c.getElementById("_iframe")?(popup._tL(a,h,e),popup._H(d)):(popup._iFH(h),popup._H(d))},stop:function(a){a.preventDefault()},_tL:function(b,c,d){var e,f=b.find(".cont").html();if(a(".out").length<=0){if(!(d.height()>c))return!0;d.empty(),a('<div class="out">'+f+"</div>").appendTo(d),a(".out").siblings().remove(),d.css({height:c+"px","overflow-y":"hidden","margin-bottom":"-6%"}),popup._iS(d,c)}else a(".out").height()>c?(d.css({height:c+"px","overflow-y":"hidden","margin-bottom":"-6%"}),popup._iS(d,c)):(e=d.children(".out").html(),d.css({height:"auto"}),d.empty(),d.append(e))},_iB:function(){a("._popup").live("touchstart",function(b){var c=a("._popup>.is");c.is(b.target)||0!==c.has(b.target).length||(popup.close(),a("._popup").die("touchstart"))})},_A:function(c,d,e,f){var g=a("._popup"),h=null,i=a("body");return g.length>0&&g.remove(),popup.htm.on("touchmove",popup.stop),popup.htm.css({"overflow-y":"hidden"}),i.append(popup.popup_tpl),g=a("._popup"),popup._T(f)&&g.find(".btnbox").css({height:"96px"}),h=g.children(".layer"),a(b).on("onorientationchange"in b?"orientationchange":"resize",function(){90==Math.abs(b.orientation)?setTimeout(function(){popup._iF(g,h)},300):setTimeout(function(){popup._iF(g,h)},300)}),b.innerWidth<b.innerHeight?i.height()<b.innerHeight?g.height(b.innerHeight):g.height(i.height()):g.height(i.height()),e?(g.html(c),void 0):(c=c.replace(/<(?!\/?BR|\/?IMG|\/?INPUT|\/?TEXTAREA|\/?IFRAME)[^<>]*>/gi,""),"string"==typeof d?h.children("div.doc").html("<h2>"+d+"</h2><div class='cont'>"+c+"</div>"):h.children("div.doc").html(c),setTimeout(function(){popup._iF(g,h)},300),popup._iB(),g.children(".layer"))},_H:function(b){var c=b.find("img");b.animate({"margin-top":~b.height()/2+"px",opacity:1},200),c.length>0?c.each(function(){a("<img/>").attr("src",a(this).attr("src")).load(function(){setTimeout(function(){},200)})}):setTimeout(function(){},100)},_iFH:function(b){var d,e=c.getElementById("_iframe"),f=a("._popup"),g=f.find(".cont"),h=c.frames?c.frames.iframepage.D:e.contentDocument;null!=h&&(d=h.body.scrollHeight,g.css({"margin-bottom":"-6%"}),popup._iI&&g.css({"-webkit-overflow-scrolling":"touch","overflow-y":"scroll"}),b>d?(e.height=d,g.height(d+"px")):(e.height=b,g.height(b+"px")))},close:function(){setTimeout(function(){popup.htm.css({"overflow-y":"auto"}),popup.htm.off("touchmove",popup.stop),a("._popup").remove()},popup._W||popup._O||popup._Q||popup._S?500:250)},alert:function(a,b,c,d,e){var f=popup._A(a,e),g=null,h=c||"确认",i=popup._M?"touchend":"mouseup";f.children(".btnbox").append('<a class="full" href="javascript://">'+h+"</a>"),d&&f.children("div.doc").css({color:d}),g=f.children(".btnbox").children("a"),g.eq(0).focus().blur(),g.on(i,function(){"function"==typeof b?b():popup.close()})},confirm:function(a,b,c,d,e,f,g){var h=popup._A(a,g,!1,b),i=null,j=e||"确认",k=f||"取消",l=popup._M?"touchend":"mouseup",m=popup._T(b)?"full":"half";h.children(".btnbox").append('<a class="'+m+'" href="javascript://">'+j+'</a><a class="'+m+'" href="javascript://">'+k+"</a>"),i=h.children(".btnbox").children("a"),i.eq(0).focus().blur(),i.eq(0).on(l,function(){"function"==typeof c?c():popup.close()}),i.eq(1).on(l,function(){"function"==typeof d?d():popup.close()})},prompt:function(c,d,e,f,g,h){setTimeout(function(){function i(a){return"number"==typeof a&&0!=a?parseInt(Math.abs(a)):300}var j=a("._cue"),k=i(g),l=i(h),m=null,n=0;j.length>0||(a("body").append(popup.cue_tpl),j=a("._cue"),m=j.children("span"),d&&m.css({color:d,background:e,fontSize:f}),m.text(c||"提示信息"),n=m.height(),m.animate({"margin-top":b.innerHeight/2-n,opacity:1},k,function(){setTimeout(function(){m.animate({"margin-top":"20rem",opacity:0},k,function(){j.remove()})},l)}))},250)},custom:function(b,c,d){popup._A('<div class="is">'+b+"</div>","",1),a(".is").addClass(c),"function"==typeof d&&d(),popup._iB()}}}(jQuery,window,document);